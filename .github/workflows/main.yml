name: Test Server Connection

on: [workflow_dispatch]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - name: Install tools
      run: sudo apt-get update && sudo apt-get install -y sshpass nc dnsutils
      
    - name: Network Diagnostic
      run: |
        echo "=== üö® –¢–ï–°–¢ –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø GITHUB -> SERVER ==="
        SERVER_IP="${{ secrets.SERVER_IP }}"
        echo "IP —Å–µ—Ä–≤–µ—Ä–∞: $SERVER_IP"
        echo ""
        
        echo "1. üîç DNS resolution:"
        nslookup $SERVER_IP || echo "‚ùå DNS FAILED"
        echo ""
        
        echo "2. üì° Ping test:"
        ping -c 4 -W 2 $SERVER_IP || echo "‚ùå PING FAILED"
        echo ""
        
        echo "3. üö™ Port 22 test:"
        timeout 5 nc -zv -w 3 $SERVER_IP 22 && echo "‚úÖ PORT 22 OPEN" || echo "‚ùå PORT 22 CLOSED"
        echo ""
        
        echo "4. üö™ Port 2222 test:"
        timeout 5 nc -zv -w 3 $SERVER_IP 2222 && echo "‚úÖ PORT 2222 OPEN" || echo "‚ùå PORT 2222 CLOSED"
        echo ""
        
        echo "5. üåê Traceroute:"
        timeout 10 traceroute -w 1 -m 10 $SERVER_IP || echo "‚ùå TRACEROUTE FAILED"
        echo ""
        
        echo "6. üìç GitHub Runner IP:"
        echo "IP runner: $(curl -s https://ifconfig.me/ip)"
        echo ""
        
        echo "=== üìû –°–æ–æ–±—â–∏—Ç–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É Reg.ru ==="
